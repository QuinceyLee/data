(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e5f5b9f"],{"2a89":function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return l}));var r=a("b775");function o(){return Object(r["a"])({url:"inends",method:"get"})}function i(e){return Object(r["a"])({url:"inends",method:"post",data:e})}function l(e){return Object(r["a"])({method:"delete",url:"inends?uuid="+e})}},dfa9:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticStyle:{height:"800px",border:"1px solid #eee"}},[a("el-main",[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("规则管理")])]),a("el-button",{attrs:{type:"primary",icon:"el-icon-help"},on:{click:function(t){e.status.createDialogVisible=!0}}},[e._v(" 新 建 ")]),a("el-button",{attrs:{type:"success",icon:"el-icon-refresh"},on:{click:e.refreshList}},[e._v(" 刷 新 ")])],1),a("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.rulesTableData,border:""}},[a("el-table-column",{attrs:{prop:"uuid",label:"UUID",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.status?a("el-tag",{attrs:{type:"success"}},[e._v("运行中")]):a("el-tag",{attrs:{type:"danger"}},[e._v("已停止")])]}}])}),a("el-table-column",{attrs:{prop:"name",label:"名称",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"description",label:"备注信息",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.openDetailsDialog(t.row)}}},[e._v(" 详情 ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.removeRule(t.row.uuid)}}},[e._v(" 删除 ")])]}}])})],1),a("el-dialog",{attrs:{title:"规则详情",visible:e.status.detailDialogVisible,width:"1000px",top:"2%"},on:{"update:visible":function(t){return e.$set(e.status,"detailDialogVisible",t)}}},[a("el-form",{ref:"ruleDetailFormRef",attrs:{model:e.ruleDetailForm,"status-icon":"","label-width":"auto"}},[a("el-form-item",{attrs:{label:"规则名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"规则名称",disabled:!0},model:{value:e.ruleDetailForm.name,callback:function(t){e.$set(e.ruleDetailForm,"name",t)},expression:"ruleDetailForm.name"}})],1),a("el-form-item",{attrs:{label:"输入资源",prop:"from"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",disabled:"",placeholder:"请选择数据源"},model:{value:e.ruleDetailForm.from,callback:function(t){e.$set(e.ruleDetailForm,"from",t)},expression:"ruleDetailForm.from"}},e._l(e.inEnds,(function(t){return a("el-option",{key:t.uuid,attrs:{label:t.name,value:t.uuid}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.uuid))]),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(" "+e._s(t.name)+" ")])])})),1)],1),a("el-form-item",{attrs:{label:"规则回调",prop:"config"}},[a("codemirror",{staticStyle:{"line-height":"1"},attrs:{options:e.options},model:{value:e.ruleDetailForm.actions,callback:function(t){e.$set(e.ruleDetailForm,"actions",t)},expression:"ruleDetailForm.actions"}})],1),a("el-form-item",{attrs:{label:"成功回调",prop:"config"}},[a("codemirror",{staticStyle:{"line-height":"1"},attrs:{options:e.options},model:{value:e.ruleDetailForm.success,callback:function(t){e.$set(e.ruleDetailForm,"success",t)},expression:"ruleDetailForm.success"}})],1),a("el-form-item",{attrs:{label:"失败回调",prop:"config"}},[a("codemirror",{staticStyle:{"line-height":"1"},attrs:{options:e.options},model:{value:e.ruleDetailForm.failed,callback:function(t){e.$set(e.ruleDetailForm,"failed",t)},expression:"ruleDetailForm.failed"}})],1),a("el-form-item",{attrs:{label:"备注信息",prop:"description"}},[a("el-input",{attrs:{autocomplete:"off",disabled:!0},model:{value:e.ruleDetailForm.description,callback:function(t){e.$set(e.ruleDetailForm,"description",t)},expression:"ruleDetailForm.description"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.status.detailDialogVisible=!1}}},[e._v(" 确 定 ")])],1)],1),a("el-dialog",{attrs:{title:"新建规则",visible:e.status.createDialogVisible,width:"1000px",top:"2%"},on:{"update:visible":function(t){return e.$set(e.status,"createDialogVisible",t)},closed:e.createDialogClosed}},[a("el-form",{ref:"createFormRef",attrs:{model:e.createForm,rules:e.createFormRules,"status-icon":"","label-width":"auto"}},[a("el-form-item",{attrs:{label:"规则名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"规则名称"},model:{value:e.createForm.name,callback:function(t){e.$set(e.createForm,"name",t)},expression:"createForm.name"}})],1),a("el-form-item",{attrs:{label:"输入资源",prop:"from"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择数据源"},model:{value:e.createForm.from,callback:function(t){e.$set(e.createForm,"from",t)},expression:"createForm.from"}},e._l(e.inEnds,(function(t){return a("el-option",{key:t.uuid,attrs:{label:t.name,value:t.uuid}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.uuid))]),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(" "+e._s(t.name)+" ")])])})),1)],1),a("el-form-item",{attrs:{label:"规则回调",prop:"config"}},[a("codemirror",{staticStyle:{"line-height":"1"},attrs:{options:e.options},model:{value:e.createForm.actions,callback:function(t){e.$set(e.createForm,"actions",t)},expression:"createForm.actions"}})],1),a("el-form-item",{attrs:{label:"成功回调",prop:"config"}},[a("codemirror",{staticStyle:{"line-height":"1"},attrs:{options:e.options},model:{value:e.createForm.success,callback:function(t){e.$set(e.createForm,"success",t)},expression:"createForm.success"}})],1),a("el-form-item",{attrs:{label:"失败回调",prop:"config"}},[a("codemirror",{staticStyle:{"line-height":"1"},attrs:{options:e.options},model:{value:e.createForm.failed,callback:function(t){e.$set(e.createForm,"failed",t)},expression:"createForm.failed"}})],1),a("el-form-item",{attrs:{label:"备注信息",prop:"description"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.createForm.description,callback:function(t){e.$set(e.createForm,"description",t)},expression:"createForm.description"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.status.createDialogVisible=!1}}},[e._v(" 取 消 ")]),a("el-button",{attrs:{type:"warning"},on:{click:e.validateRule}},[e._v("语法验证")]),a("el-button",{attrs:{type:"primary",loading:e.status.addRuleLoading},on:{click:e.createRule}},[e._v(" 提 交 ")])],1)],1)],1)],1)},o=[],i=a("5530"),l=a("ade3"),s=(a("a15b"),a("2b0e")),n=a("8f94"),c=(a("a7be"),a("7ba3"),a("8eb3"),a("27f7")),u=(a("5c96"),a("2a89")),d=a("b775");function m(){return Object(d["a"])({url:"rules",method:"get"})}function f(e){return Object(d["a"])({url:"rules",method:"post",data:e})}function p(e){return Object(d["a"])({method:"delete",url:"rules?uuid="+e})}function b(e){return Object(d["a"])({url:"validateRule",method:"post",data:e})}s["default"].use(c["a"]);var g={name:"Rule",data:function(){var e;return{options:(e={tabSize:4,mode:"text/x-lua",theme:"darcula",lineNumbers:!0,line:!0,lint:!0,styleActiveLine:!0},Object(l["a"])(e,"lineNumbers",!0),Object(l["a"])(e,"foldGutter",!0),Object(l["a"])(e,"styleSelectedText",!0),Object(l["a"])(e,"matchBrackets",!0),Object(l["a"])(e,"showCursorWhenSelecting",!0),Object(l["a"])(e,"gutters",["CodeMirror-lint-markers"]),Object(l["a"])(e,"hintOptions",{completeSingle:!0}),Object(l["a"])(e,"extraKeys",{Tab:function(e){var t=Array(e.getOption("indentUnit")+1).join(" ");e.replaceSelection(t)}}),Object(l["a"])(e,"showHint",!0),e),detailOptions:{modes:["code"],mode:"code",ace:ace},inEnds:[],ruleDetailForm:{},rulesTableData:[],createForm:{name:"",description:"",from:[],actions:"Actions = {\n\tfunction(data)\n\t\t\n\t\treturn true, data\n\tend\n}",failed:"function Failed(error)\n\t\nend\n",success:"function Success()\n\t\nend\n"},createFormRules:{name:[{required:!0,message:"输入名称",trigger:["blur","change"]}],description:[{required:!0,message:"输入描述",trigger:["blur","change"]}],from:[{required:!0,message:"输入资源入口",trigger:["blur","change"]}],actions:[{required:!0,message:"输入规则回调",trigger:["blur","change"]}],failed:[{required:!0,message:"输入成功回调",trigger:["blur","change"]}],success:[{required:!0,message:"输入失败回调",trigger:["blur","change"]}]},status:{addRuleLoading:!1,detailDialogVisible:!1,createDialogVisible:!1}}},components:{codemirror:n["codemirror"],VJsonEditor:c["a"]},created:function(){this.getRuleList(),this.getInEndList()},methods:{removeRule:function(e){var t=this;this.$msgbox({title:"提示",message:"确定要删除该规则吗",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:function(a,r,o){"confirm"===a?(r.confirmButtonLoading=!0,p(e).then((function(e){t.$message.success(e.msg),t.getRuleList(),o(),setTimeout((function(){r.confirmButtonLoading=!1}),300)})).catch((function(){r.confirmButtonLoading=!1}))):o()}})},openDetailsDialog:function(e){this.ruleDetailForm=e,this.status.detailDialogVisible=!0},refreshList:function(){this.getRuleList(),this.getInEndList()},createRule:function(){var e=this;this.$refs.createFormRef.validate((function(t){if(t){var a=Object(i["a"])({},e.createForm);e.status.addRuleLoading=!0,f(a).then((function(){e.$message.success("创建成功"),e.status.createDialogVisible=!1,e.getRuleList()})).catch((function(){e.status.addRuleLoading=!1}))}}))},getRuleList:function(){var e=this;m().then((function(t){e.rulesTableData=t.data}))},getInEndList:function(){var e=this;Object(u["b"])().then((function(t){e.inEnds=t.data}))},validateRule:function(){var e=this;b(this.createForm).then((function(t){e.$message.success("语法验证成功")}))},createDialogClosed:function(){this.status.addRuleLoading=!1,this.$refs.createFormRef.resetFields(),this.createForm=this.$options.data().createForm}}},h=g,v=a("2877"),F=Object(v["a"])(h,r,o,!1,null,null,null);t["default"]=F.exports}}]);